import e from"clipboard";import{disableBodyScroll as t,enableBodyScroll as n}from"body-scroll-lock";import{debounce as a}from"lodash-es";const o="undefined"==typeof window,r=new Map;let l;function c(e,t){let n=[];return Array.isArray(t.arg)?n=t.arg:n.push(t.arg),function(a,o){const r=t.instance.popperRef,l=a.target,c=o.target,i=!t||!t.instance,s=!l||!c,d=e.contains(l)||e.contains(c),u=e===l,p=n.length&&n.some((e=>null==e?void 0:e.contains(l)))||n.length&&n.includes(c),f=r&&(r.contains(l)||r.contains(c));i||s||d||u||p||f||t.value()}}o||(document.addEventListener("mousedown",(e=>l=e)),document.addEventListener("mouseup",(e=>{for(const{documentHandler:t}of r.values())t(e,l)})));const i={beforeMount(e,t){r.set(e,{documentHandler:c(e,t),bindingFn:t.value})},updated(e,t){r.set(e,{documentHandler:c(e,t),bindingFn:t.value})},unmounted(e){r.delete(e)}},s={install:e=>{e.directive("click-outside",i)}},d={mounted:(t,n)=>{const{arg:a,value:o}=n,r=()=>o&&"function"==typeof o&&o();switch(a){case"success":t.clipboardSuccessHandler=r;break;case"error":t.clipboardErrorHandler=r;break;default:{t.clipboardHandler=r;const n=new e(t,{text:()=>o,action:()=>"cut"===a?"cut":"copy"});n.on("success",(e=>{const n=t.clipboardSuccessHandler;n&&n(e)})),n.on("error",(e=>{const n=t.clipboardErrorHandler;n&&n(e)})),t.clipboardInstance=n}}},updated:(e,t)=>{const{arg:n,value:a}=t;switch(n){case"success":e.clipboardSuccessHandler=a;break;case"error":e.clipboardErrorHandler=a;break;default:e.clipboardInstance.text=function(){return t.value},e.clipboardInstance.action=function(){return"cut"===t.arg?"cut":"copy"}}},unmounted:(e,t)=>{const{arg:n}=t;switch(n){case"success":delete e.clipboardSuccessHandler;break;case"error":delete e.clipboardErrorHandler;break;default:e.clipboardInstance.destroy(),delete e.clipboardInstance}}},u={install:e=>{e.directive("clipboard",d)}},p={checkFunc:()=>!0},f={mounted:(e,t)=>{const n=t.value;if(n&&p.checkFunc){p.checkFunc(n)||e.parentNode&&e.parentNode.removeChild(e)}}},h={install:(e,t)=>{console.log(t),(null==t?void 0:t.checkFunc)&&(p.checkFunc=t.checkFunc),e.directive("permission",f)}};let m={defaultWatermark:"Test Text",font:"16px Microsoft JhengHei",fontColor:"rgba(180, 180, 180, 0.3)",width:200,height:200,angle:-20*Math.PI/180};const v={created:(e,t)=>{((e,t)=>{const n=document.createElement("canvas");e.appendChild(n),n.width=(t&&"string"!=typeof t?t.width:m.width)||m.width,n.height=(t&&"string"!=typeof t?t.height:m.height)||m.height,n.style.display="none";const a=n.getContext("2d");if(a){a.rotate(t&&"string"!=typeof t&&t.angle||m.angle),a.font=(t&&"string"!=typeof t?t.font:m.font)||"",a.fillStyle=(t&&"string"!=typeof t?t.fontColor:m.fontColor)||"rgba(180, 180, 180, 0.3)",a.textAlign="left",a.textBaseline="middle";const e=t&&"string"!=typeof t?t.text||m.defaultWatermark:t;a.fillText(e,n.width/10,n.height/2)}e.style.backgroundImage="url("+n.toDataURL("image/png")+")"})(e,t.value)}},g={install:(e,t)=>{m=Object.assign({},m,t),e.directive("water-marker",v)}};let b={};const y={mounted:(e,n)=>{n.value&&t(e,b)},updated:(e,a)=>{a.value?t(e,b):n(e)},unmounted:e=>{n(e)}},k={install:(e,t)=>{t&&(b=t),e.directive("scroll-lock",y)}},w={delay:50,interval:400},x={created:(e,t)=>{if("function"==typeof t.value){let n,a;const o=()=>{null!==n&&(clearTimeout(n),n=null),a&&(clearInterval(a),a=null)},r=e=>{t.value(e)},l=e=>{"click"===e.type&&0!==e.button||null===n&&(n=setTimeout((()=>{w.interval&&w.interval>0&&(a=setInterval((()=>{r(e)}),w.interval)),r(e)}),w.delay))};["mousedown","touchstart"].forEach((t=>e.addEventListener(t,l))),["click","mouseout","touchend","touchcancel"].forEach((t=>e.addEventListener(t,o)))}}},H={install:(e,t)=>{(null==t?void 0:t.interval)&&(w.interval=t.interval),(null==t?void 0:t.delay)&&(w.delay=t.delay),e.directive("long-click",x)}};let E={delay:200,ratio:1,minFontSize:"16px",maxFontSize:"500px"};const F=function(e,t){e.style.fontSize=Math.max(Math.min(e.clientWidth/(10*t.ratio),parseFloat(t.maxFontSize)),parseFloat(t.minFontSize))+"px"},S={mounted:(e,t)=>{const{value:n}=t,o=Object.assign({},E,n);e.__opts=o,e.__debounceHandler=a((function(){F(e,o)}),o.delay),"undefined"!=typeof window&&window.addEventListener("resize",e.__debounceHandler,{passive:!0}),F(e,o)},unmounted:e=>{"undefined"!=typeof window&&window.removeEventListener("resize",e.__debounceHandler)}},z={install:(e,t)=>{t&&(E=t),e.directive("resize-text",S)}},C=[s,u,h,g,k,H,z],I={install:e=>{C.forEach((t=>{e.use(t)}))}};export{s as ClickOutside,u as Clipboard,H as LongClick,h as Permission,z as ResizeText,k as ScrollLock,g as WaterMarker,I as default};
